(this["webpackJsonpimage-sheetifier"]=this["webpackJsonpimage-sheetifier"]||[]).push([[0],{19:function(e,t,n){},22:function(e,t,n){},23:function(e,t,n){},24:function(e,t,n){},25:function(e,t,n){},26:function(e,t,n){"use strict";n.r(t);var a=n(1),i=n.n(a),s=n(11),l=n.n(s),r=(n(19),n(3)),c=n(4),o=n(7),u=n(6),d=n(0),h=function(){return Object(d.jsxs)("header",{children:[Object(d.jsx)("h1",{children:"Image Sheetifier"}),Object(d.jsx)("h2",{children:"Transform your images into excel spreadsheets"})]})},p=n(5),j=n.n(p),f=n(12),g=n(2),b=n(13),m=n(14),v=n(9),x=(n(22),function(e){var t=e.input?{className:"input-preview",src:e.input}:{className:"img-type-logo",src:"/image-sheetifier/IMG-file.svg"};return Object(d.jsxs)("div",{className:"box-wrapper",children:[e.input&&Object(d.jsx)("span",{className:"close",onClick:e.onClear}),Object(d.jsx)("img",Object(v.a)(Object(v.a)({id:"input"},t),{},{alt:"Input"})),Object(d.jsxs)("label",{id:"upload",className:e.input?"disabled":"",children:[Object(d.jsx)("input",{disabled:!!e.input,type:"file",accept:".jpg, .jpeg, .png",onChange:e.onChange}),"Upload"]})]})}),O=(n(23),function(e){return Object(d.jsxs)("div",{className:"box-wrapper",children:[Object(d.jsx)("img",{id:"excel",className:"img-type-logo",src:e.output?e.output:"/image-sheetifier/XLSX-file.svg",alt:"Input"}),Object(d.jsxs)("label",{id:"download",className:e.file?"":"disabled",children:[Object(d.jsx)("button",{disabled:!e.file,onClick:e.onClick}),"Download"]})]})}),w=(n(24),function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={input:null,output:null,file:null,name:null},e.handleFileChange=function(t){if(0!==t.target.files.length){var n=new FileReader;n.readAsDataURL(t.target.files[0]),e.setState({name:t.target.files[0].name.replace(/\.[^/.]+$/,"")}),n.onload=function(e){this.setState({input:e.target.result})}.bind(Object(g.a)(e))}else e.handleClearUpload()},e.handleClearUpload=function(){e.setState({input:null,output:null,file:null,name:null})},e.handleImageProcessing=function(){var t=e.state.input;if(t){var n=document.createElement("img");n.src=t,n.onload=function(e){var t=document.createElement("canvas"),n=100/e.target.width;t.width=100,t.height=e.target.height*n;var a=t.getContext("2d");a.drawImage(e.target,0,0,t.width,t.height);for(var i=a.getImageData(0,0,t.width,t.height),s=a.canvas.toDataURL(e.target,"image/jpeg"),l=i.data,r=new b.Workbook,c=r.addWorksheet("sheet"),o=1;o<=100;o++)c.getColumn(o).width=3;for(var u=c.getRow(1),d=1,h=1,p=0;p<l.length;p+=4)u.getCell(h).fill={type:"pattern",pattern:"solid",fgColor:{argb:this.intToHex(l[p+3])+this.intToHex(l[p])+this.intToHex(l[p+1])+this.intToHex(l[p+2])}},100===h?(h=1,d++,u=c.getRow(d)):h++;this.setState({output:s,file:r})}.bind(Object(g.a)(e))}},e.handleDownload=function(){var t=e.state,n=t.file,a=t.name;e.saveFile(a,n)},e}return Object(c.a)(n,[{key:"intToHex",value:function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t}},{key:"saveFile",value:function(){var e=Object(f.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.xlsx.writeBuffer({base64:!0});case 2:a=e.sent,Object(m.saveAs)(new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),t);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.input,n=e.output,a=e.file;return Object(d.jsx)("div",{children:Object(d.jsxs)("div",{className:"converter-container",children:[Object(d.jsx)("section",{className:"uploader",children:Object(d.jsx)(x,{input:t,onChange:this.handleFileChange,onClear:this.handleClearUpload})}),Object(d.jsx)("section",{className:"downloader",children:Object(d.jsx)(O,{output:n,file:a,onClick:this.handleDownload})}),Object(d.jsx)("button",{id:"process",className:!t||a?"disabled":"",disabled:!t||!!a,onClick:this.handleImageProcessing,children:"Process"})]})})}}]),n}(a.Component)),C=(n(25),function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return Object(d.jsx)("div",{className:"App",children:Object(d.jsxs)("div",{className:"App-wrapper",children:[Object(d.jsx)(h,{}),Object(d.jsx)(w,{})]})})}}]),n}(a.Component)),k=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,27)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,s=t.getLCP,l=t.getTTFB;n(e),a(e),i(e),s(e),l(e)}))};l.a.render(Object(d.jsx)(i.a.StrictMode,{children:Object(d.jsx)(C,{})}),document.getElementById("root")),k()}},[[26,1,2]]]);
//# sourceMappingURL=main.7e12c1ca.chunk.js.map